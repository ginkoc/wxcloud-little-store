<view class="container">
  <view class="header">
    <text class="title">ç¡®è®¤è®¢å•</text>
  </view>
  
  <!-- åœ°å€ä¿¡æ¯ - ä¿®æ”¹ä¸ºç±»ä¼¼å›¾ç‰‡ä¸­çš„æ ·å¼ -->
  <view class="address-bar" bindtap="navigateToAddressSelect">
    <view class="address-icon">
      <text class="icon">ğŸ“</text>
    </view>
    <view class="address-info">
      <text class="address-label" wx:if="{{!address.contactName}}">è¯·é€‰æ‹©æ”¶è´§åœ°å€</text>
      <view class="address-content" wx:else>
        <view class="address-detail">
          <text class="delivery-to">é€è‡³: </text>
          <text class="address-text">{{address.street}}</text>
        </view>
        <view class="contact-info">
          <text class="contact-name">{{address.contactName}}</text>
          <text class="contact-phone">{{address.contactPhone}}</text>
        </view>
      </view>
    </view>
    <view class="address-arrow">
      <text class="arrow-icon">></text>
    </view>
  </view>
  
  <!-- è®¢å•å•†å“ -->
  <view class="order-items">
    <view class="section-title">è®¢å•å•†å“</view>
    
    <view class="item-list">
      <view class="item" wx:for="{{cartItems}}" wx:key="_id">
        <image 
          class="item-image" 
          src="{{item.imageURL || '/images/default-product.png'}}"
          mode="aspectFill"
          lazy-load="true"
        ></image>
        <view class="item-info">
          <text class="item-name">{{item.productName}}</text>
          <view class="item-price-qty">
            <text class="item-price">Â¥{{item.formattedPrice}}</text>
            <text class="item-qty">Ã—{{item.quantity}}</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- å•†å“æ•°é‡å’Œå°è®¡ -->
    <view class="order-summary-bar">
      <text class="order-count">å…±{{totalItems}}ä»¶å•†å“</text>
      <text class="order-subtotal">å°è®¡: <text class="price-highlight">Â¥{{formattedOriginalPrice}}</text></text>
    </view>
    
    <!-- è®¢å•å¤‡æ³¨ -->
    <view class="remark-section">
      <text class="remark-label">è®¢å•å¤‡æ³¨</text>
      <textarea class="remark-input" placeholder="è¯·è¾“å…¥è®¢å•å¤‡æ³¨ä¿¡æ¯ï¼ˆé€‰å¡«ï¼Œå¦‚é…é€æ—¶é—´ã€ç‰¹æ®Šè¦æ±‚ç­‰ï¼‰" value="{{remark}}" bindinput="inputRemark"></textarea>
    </view>
  </view>
  
  <!-- ä»·æ ¼ä¿¡æ¯ -->
  <view class="price-section">
    <view class="section-title">ä»·æ ¼æ˜ç»†</view>
    
    <view class="price-list">
      <view class="price-item">
        <text class="label">å•†å“æ€»é¢</text>
        <text class="value">Â¥{{formattedOriginalPrice}}</text>
      </view>
      
      <view class="price-item" wx:if="{{discountFee > 0}}">
        <text class="label">ä¼˜æƒ æŠ˜æ‰£</text>
        <text class="value discount">-Â¥{{formattedDiscountAmount}}</text>
      </view>
      
      <view class="price-item">
        <text class="label">é…é€è´¹ç”¨</text>
        <text class="value">Â¥0.00</text>
      </view>
      
      <view class="price-divider"></view>
      
      <view class="price-item total">
        <text class="label">åº”ä»˜é‡‘é¢</text>
        <text class="total-price">Â¥{{formattedTotalPrice}}</text>
      </view>
    </view>
  </view>
  
  <!-- æäº¤è®¢å• -->
  <view class="submit-section">
    <view class="submit-info">
      <text class="total-label">åˆè®¡:</text>
      <text class="total-price">Â¥{{formattedTotalPrice}}</text>
      <text class="item-count">({{totalItems}}ä»¶å•†å“)</text>
    </view>
    <button class="submit-btn {{isSubmitting ? 'disabled' : ''}}" bindtap="submitOrder" disabled="{{isSubmitting}}">
      {{isSubmitting ? 'æäº¤ä¸­...' : 'æäº¤è®¢å•'}}
    </button>
  </view>
</view> 